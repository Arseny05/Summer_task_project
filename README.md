Версия python - 3.10.12
Версия pyspark - 4.0.0
Программа получает на вход два аргумента: конфигурационный xml-файл с описанием параметров японской свечи и входной csv-файл, содержащий совокупность сделок через через параметры программы, т.е. как argv[1] и argv[2] соответственно
Используемые библиотеки:
1) sys - для считывания входных параметров как argv[1] и argv[2] соответственно
2) pyspark - для обработки RDD сделок
3) xml.etree.ElementTree - для парсинга входного xml-файла
4) datetime - для удобной обработки времени сделок и начала свечей
5) csv - для обработки csv файла
6) os - для создания файлов, содержащих выходные японские свечи
7) pyspark.sql - для импорта spark-сессии
   
Пользовательские функции:

1) xml_Parse - считывает конфигурационный xml-файл, парсит его, заполняя словарь Config, недостающие значения берем из слоавря Default, содержащего значения параметров по умолчанию
2) accur - функция, округляющая числа до десятых. Использована вместо round, так как в некоторых случаях round округлял некорректно, что приводило к некорректному решению
3) map_func - функция, преобразующая последовательность сделок в ((#SYMBOL,interval),(PRICE_DEAL,ID_DEAL,Moment)), где #SYMBOL- исходный символ сделки, interval- начало японской свечи, к которой относится сделка, Price_Deal - цена сделки, ID_DEAL - ID сделки, Moment- время совершения сделки
4) reduce_func - функция, применяющаяся к элементам, имеющим одинаковый ключ, т.е. одинаковый Id и одинаковую свечь, к которой они принадлежат. Сортирует сделки по времени, а в случае равенства времени - по Id (так мы выполняем требование задания, касаемо разрешения цены в начале и конце свечи). На выходе получаем японскую свечь.
5) get_symbol - функция, вычленяющая символ японской свечи, для того, чтобы свечи с одинаковым символом позже пошли в один файл.
6) in_file - функция, записывающая свечи с одинаковым символом в один файл, который так же создается в этой функции.

Ход работы программы: программа получает с помощью argv[1] путь к xml-файлу конфигурации, который с помощью функции xml_Parse обрабатывается, записывая в словарь Config параметры свечи. Далее, запускается SparkSession и с помощью argv[2] в нее записываются сделки из входного csv-файла.
Далее преобразуем ее в RDD для удобство работы и маппируем с помощью map_func, получив на выходе последовательность сделок с одинаковым ключом. Сделки, не попадающие в рассматриваемый интервал для свечей отметаем с помощью функции filter. Далее группируем сделки по ключу и применяем к ним reduce_func, получая на выходе японские свечи.
Теперь снова строим последовательность вида (Symbol, candle) с помощью функций map и get_symbol, чтобы сгруппировать свечи с одинаковым Id. Последним шагом, группируем свечи по ключу, т.е. по Id и применяем к ним функцию in_file для записи в файлы, после завершаем SparkSession.     
